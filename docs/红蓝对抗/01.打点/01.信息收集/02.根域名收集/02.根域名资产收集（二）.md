```
https://zone.huoxian.cn/d/553-101

红蓝对抗之企业对外根域名资产收集
https://zone.huoxian.cn/d/257

企业根域名资产收集细节再补充
https://zone.huoxian.cn/d/103

信息收集系列之子域名发现
https://zone.huoxian.cn/d/275

信息收集系列之善用搜索引擎
https://zone.huoxian.cn/d/285

信息收集系列之domain_hunter_pro使用
https://zone.huoxian.cn/d/316-domain-hunter-pro


信息收集系列之JavaScript文件敏感信息提取
https://zone.huoxian.cn/d/336-javascript

信息收集系列之指纹识别
https://zone.huoxian.cn/d/372

信息收集系列之自动化工具ShuiZe_0x727
https://zone.huoxian.cn/d/396-shuize-0x727

信息收集系列之网站快照
https://zone.huoxian.cn/d/461

信息收集系列之资产风险监测系统Biu
https://zone.huoxian.cn/d/514-biu

信息收集之“骚”姿势 @鱼七
https://zone.huoxian.cn/d/618
```

# 0x01 通过PTR记录收集

PTR记录，是电子邮件系统中的邮件交换记录的一种；另一种邮件交换记录是A记录（在IPv4协议中）或AAAA记录（在IPv6协议中）。PTR记录常被用于反向地址解析。尽可能多的收集目标的IP地址，然后通过PTR记录反向查询域名

## 1.收集IP段

https://bgp.he.net/search?search%5Bsearch%5D=tesla&commit=Search

![image-20220628143048366](https://cdn.jsdelivr.net/gh/R1card0-tutu/R1card0-tutu@main/img/202206281430791.png)

## 2.正则提取IP段

```
(\d{1,3}\.){3}\d{1,3}\/\d{1,2}
```

## 3.解析PTR记录

```
cat tesla.txt | mapcidr -silent | dnsx -silent -ptr -resp-only -o output.txt
```

## 4.提取根域名

```
cat ~/Desktop/output.txt | python extract-root-domain.py - 
```

提取脚本

```python
import click
from wsltools.domaintools import domain

def generate(results):
 for result in results:
 if domain(result).valid:
 yield domain(result).main

@click.command()
@click.argument('filename', required=True, type=click.File(mode='r'))

def main(filename):
 results = filename.read().splitlines()
 for r in set(generate(results)):
 click.echo(r)

if __name__ == "__main__":
 main()
```

# 0x03 WHOIS反查接口推荐

https://drs.whoisxmlapi.com/reverse-whois-search

![image-20220628144841641](https://cdn.jsdelivr.net/gh/R1card0-tutu/R1card0-tutu@main/img/202206281448771.png)

# 0x04 SSL证书扩展补充

除了通过fofa、shodan、zoomeye、quake等空间描绘搜索引擎，还可以通过http://tls.bufferover.run/收集

```
curl 'https://tls.bufferover.run/dns?q=.goodrv.com' -H 'x-api-key: AOQAtcfMK02TFg5BwMIJH4b621XQpBNCap8j0GPc'
```

通过ip获取tls证书

```
echo 'https://183.201.217.110/' | httpx -json -silent | jq
```

![img](https://cdn.jsdelivr.net/gh/R1card0-tutu/R1card0-tutu@main/img/202206281529800.png)

# 0x05 Hackerone

一些在hackerone上进行众测的厂商，会把自己的测试范围列举出来，其中就包含有大量的域名，因此通过hackerone来完善资产收集也是一个不错的方法。

https://hackerone.com/alibaba?type=team&view_policy=true

![image-20220628153130720](https://cdn.jsdelivr.net/gh/R1card0-tutu/R1card0-tutu@main/img/202206281531824.png)

# 0x05 Google

Google直接搜索里面的一些关键内容来查询，比如公司名、备案、引用的特殊js等

```
intext:浙ICP备09002987号 intext:33010002000070 -www
```

